#!/usr/bin/python3

import argparse
import os

def split_nmap_file(input_file, output_dir):
    try:
        if not os.path.exists(output_dir):
            os.makedirs(output_dir)

        with open(input_file, 'r') as file:
            lines = file.readlines()

        current_host = None
        current_file = None

        for line in lines:
            if line.startswith('Nmap scan report for '):
                if current_file:
                    current_file.close()

                current_host = line.split(' ')[4].strip()
                current_file_path = os.path.join(output_dir, f'{current_host}_scan.txt')
                current_file = open(current_file_path, 'w')

            if current_file:
                current_file.write(line)

        if current_file:
            current_file.close()

        print("Splitting complete.")
    except Exception as e:
        print(f"An error occurred: {e}")

def main():
    parser = argparse.ArgumentParser(description='Split Nmap scan file into separate files for each host.')
    parser.add_argument('input_file', help='Path to the Nmap scan file')
    parser.add_argument('output_dir', help='Directory to save the split files')
    args = parser.parse_args()

    split_nmap_file(args.input_file, args.output_dir)

if __name__ == "__main__":
    main()

